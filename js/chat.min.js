var container=document.getElementById("js-container"),inputMessage=document.getElementById("js-sendmessage");messageContainer=document.getElementById("js-messages"),backButton=document.getElementById("js-backbutton");var HttpClient=function(){this.get=function(e,t){var s=new XMLHttpRequest;s.onreadystatechange=function(){4==s.readyState&&200==s.status&&t(s.responseText)},s.open("GET",e,!0),s.send(null)}};function sendMessage(e){e&&createMessage(e,"fromuser",!0)}function generateMessage(){(new HttpClient).get("https://baconipsum.com/api/?type=meat-and-filler",function(e){e.length>50?createMessage(e.substring(2,50),"touser",!0):createMessage("Random Message","touser",!0)})}function createMessage(e,t,s){var n=document.createElement("P"),a=document.createTextNode(e);n.appendChild(a);var r=document.createElement("DIV");r.className="bubbletext",r.appendChild(n);var o=document.createElement("DIV");o.className="bubbletext-container "+t,o.appendChild(r);var i=document.createElement("IMG");i.setAttribute("src","fromuser"===t?"/img/myprofile_thumb.jpg":"/img/profile_thumb.jpg");var m=document.createElement("DIV");if(m.className="userpicture",m.appendChild(i),"touser"===t){var c=document.createElement("DIV");c.className="status",m.appendChild(c),m.addEventListener("click",function(){location.href="/index.html"})}var g=document.createElement("DIV");g.className="message",g.appendChild(o),g.appendChild(m),messageContainer.appendChild(g),g.scrollIntoView(!1),s&&pushMessage(e,t)}function getStorageElement(e){return sessionStorage?sessionStorage.getItem(e):null}function setStorageElement(e,t){if(!sessionStorage)return!1;sessionStorage.setItem(e,t)}function pushMessage(e,t){if(!sessionStorage)return!1;var s=getStorageElement("messages")?JSON.parse(getStorageElement("messages")):[];s.push({sender:t,message:e}),sessionStorage.setItem("messages",JSON.stringify(s))}window.onload=function(){if(getStorageElement("messages")){var e=getStorageElement("messages");e&&(e=JSON.parse(getStorageElement("messages"))).forEach(function(e){createMessage(e.message,e.sender,!1)})}else setStorageElement("messages","");generateMessage(),inputMessage.addEventListener("keydown",function(e){if(13==e.which||13==e.keyCode)return sendMessage(e.srcElement.value),this.value="",!1}),backButton.addEventListener("click",function(){location.href="/index.html"})};